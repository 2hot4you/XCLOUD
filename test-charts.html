<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>图表优化测试</title>
    <script src="https://cdn.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js"></script>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'Helvetica Neue', Helvetica, Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        .title {
            text-align: center;
            color: #333;
            margin-bottom: 30px;
        }
        .chart-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }
        .chart-card {
            background: white;
            border-radius: 16px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
            padding: 20px;
        }
        .chart-title {
            font-size: 18px;
            font-weight: 600;
            color: #2d3748;
            margin: 0 0 20px 0;
            text-align: center;
        }
        .chart {
            width: 100%;
            height: 300px;
        }
        .optimization-notes {
            background: white;
            border-radius: 16px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
            padding: 20px;
            margin-top: 20px;
        }
        .optimization-notes h3 {
            color: #2d3748;
            margin-top: 0;
        }
        .optimization-notes ul {
            color: #4a5568;
            line-height: 1.6;
        }
        .optimization-notes li {
            margin-bottom: 8px;
        }
        .highlight {
            background-color: #e6f7ff;
            padding: 2px 6px;
            border-radius: 4px;
            color: #1890ff;
            font-weight: 500;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1 class="title">XCloud 控制台图表优化测试</h1>
        
        <div class="chart-container">
            <div class="chart-card">
                <h3 class="chart-title">收入趋势图 (优化后)</h3>
                <div id="revenueChart" class="chart"></div>
            </div>
            
            <div class="chart-card">
                <h3 class="chart-title">云平台分布图 (优化后)</h3>
                <div id="platformChart" class="chart"></div>
            </div>
        </div>
        
        <div class="optimization-notes">
            <h3>优化内容说明</h3>
            <h4>折线图优化：</h4>
            <ul>
                <li><span class="highlight">时间轴</span>：改为显示最近12个月的真实月份，最后一个月为当前月</li>
                <li><span class="highlight">网格线</span>：添加清晰的水平网格线，提升可读性</li>
                <li><span class="highlight">字体优化</span>：增大字体大小，调整颜色对比度，确保清晰可读</li>
                <li><span class="highlight">工具提示</span>：美化tooltip样式，显示格式化的金额信息</li>
                <li><span class="highlight">视觉效果</span>：添加阴影效果，增强立体感</li>
            </ul>
            
            <h4>饼状图优化：</h4>
            <ul>
                <li><span class="highlight">默认标签</span>：默认显示所有数据标签和百分比，无需鼠标悬浮</li>
                <li><span class="highlight">标签线</span>：优化标签引导线样式，提升视觉清晰度</li>
                <li><span class="highlight">工具提示</span>：美化tooltip，显示详细的数值和百分比信息</li>
                <li><span class="highlight">交互效果</span>：保留鼠标悬浮的强调效果，增强用户体验</li>
                <li><span class="highlight">边框优化</span>：添加白色边框和阴影效果，增强区块分离度</li>
            </ul>
        </div>
    </div>

    <script>
        // 生成最近12个月的数据
        function generateRecentMonths() {
            const months = []
            const currentDate = new Date()
            
            for (let i = 11; i >= 0; i--) {
                const date = new Date(currentDate.getFullYear(), currentDate.getMonth() - i, 1)
                months.push(`${date.getMonth() + 1}月`)
            }
            
            return months
        }

        // 生成对应的收入数据
        function generateRevenueData() {
            const baseValue = 1500
            return Array.from({ length: 12 }, (_, i) => {
                const growth = Math.random() * 500 + i * 150
                return Math.round(baseValue + growth)
            })
        }

        // 初始化收入趋势图
        const revenueChart = echarts.init(document.getElementById('revenueChart'))
        const revenueOption = {
            tooltip: {
                trigger: 'axis',
                backgroundColor: 'rgba(255, 255, 255, 0.95)',
                borderColor: '#E5E7EB',
                borderWidth: 1,
                textStyle: {
                    color: '#374151',
                    fontSize: 14
                },
                formatter: function(params) {
                    const data = params[0]
                    return `
                        <div style="padding: 4px;">
                            <div style="font-weight: 600; margin-bottom: 4px;">${data.name}</div>
                            <div style="color: #1890ff;">
                                <span style="display: inline-block; width: 10px; height: 10px; background-color: #1890ff; border-radius: 50%; margin-right: 6px;"></span>
                                收入: ¥${(data.value * 1000).toLocaleString()}
                            </div>
                        </div>
                    `
                }
            },
            grid: {
                left: '60px',
                right: '30px',
                bottom: '50px',
                top: '30px',
                containLabel: false
            },
            xAxis: {
                type: 'category',
                data: generateRecentMonths(),
                axisLine: {
                    show: true,
                    lineStyle: {
                        color: '#D1D5DB',
                        width: 1
                    }
                },
                axisTick: {
                    show: true,
                    lineStyle: {
                        color: '#D1D5DB'
                    }
                },
                axisLabel: {
                    color: '#6B7280',
                    fontSize: 13,
                    fontWeight: 500
                },
                splitLine: {
                    show: false
                }
            },
            yAxis: {
                type: 'value',
                axisLine: {
                    show: false
                },
                axisTick: {
                    show: false
                },
                axisLabel: {
                    color: '#6B7280',
                    fontSize: 13,
                    fontWeight: 500,
                    formatter: function(value) {
                        return `¥${(value * 1000).toLocaleString()}`
                    }
                },
                splitLine: {
                    show: true,
                    lineStyle: {
                        color: '#F3F4F6',
                        width: 1,
                        type: 'solid'
                    }
                }
            },
            series: [{
                name: '收入',
                type: 'line',
                smooth: true,
                data: generateRevenueData(),
                lineStyle: {
                    color: '#1890ff',
                    width: 3,
                    shadowColor: 'rgba(24, 144, 255, 0.3)',
                    shadowBlur: 10
                },
                itemStyle: {
                    color: '#1890ff',
                    borderColor: '#ffffff',
                    borderWidth: 2,
                    shadowColor: 'rgba(24, 144, 255, 0.3)',
                    shadowBlur: 5
                },
                areaStyle: {
                    color: {
                        type: 'linear',
                        x: 0,
                        y: 0,
                        x2: 0,
                        y2: 1,
                        colorStops: [
                            { offset: 0, color: 'rgba(24, 144, 255, 0.25)' },
                            { offset: 0.5, color: 'rgba(24, 144, 255, 0.1)' },
                            { offset: 1, color: 'rgba(24, 144, 255, 0.02)' }
                        ]
                    }
                },
                symbol: 'circle',
                symbolSize: 6,
                emphasis: {
                    itemStyle: {
                        color: '#1890ff',
                        borderColor: '#ffffff',
                        borderWidth: 3,
                        shadowColor: 'rgba(24, 144, 255, 0.5)',
                        shadowBlur: 10
                    },
                    lineStyle: {
                        width: 4
                    }
                }
            }]
        }
        
        revenueChart.setOption(revenueOption)

        // 初始化饼状图
        const platformChart = echarts.init(document.getElementById('platformChart'))
        
        const data = [
            { value: 1048, name: '腾讯云', itemStyle: { color: '#1890ff' } },
            { value: 735, name: '阿里云', itemStyle: { color: '#52c41a' } },
            { value: 580, name: '华为云', itemStyle: { color: '#faad14' } },
            { value: 484, name: 'AWS', itemStyle: { color: '#f5222d' } }
        ]
        
        const total = data.reduce((sum, item) => sum + item.value, 0)
        
        const platformOption = {
            tooltip: {
                trigger: 'item',
                backgroundColor: 'rgba(255, 255, 255, 0.95)',
                borderColor: '#E5E7EB',
                borderWidth: 1,
                textStyle: {
                    color: '#374151',
                    fontSize: 14
                },
                formatter: function(params) {
                    const percentage = ((params.value / total) * 100).toFixed(1)
                    return `
                        <div style="padding: 4px;">
                            <div style="font-weight: 600; margin-bottom: 4px;">${params.name}</div>
                            <div style="color: ${params.color};">
                                <span style="display: inline-block; width: 10px; height: 10px; background-color: ${params.color}; border-radius: 50%; margin-right: 6px;"></span>
                                使用量: ${params.value}万元 (${percentage}%)
                            </div>
                        </div>
                    `
                }
            },
            legend: {
                bottom: '10',
                left: 'center',
                textStyle: {
                    color: '#6B7280',
                    fontSize: 13,
                    fontWeight: 500
                },
                itemGap: 20
            },
            series: [{
                name: '云平台使用量',
                type: 'pie',
                radius: ['35%', '70%'],
                center: ['50%', '42%'],
                avoidLabelOverlap: true,
                label: {
                    show: true,
                    position: 'outside',
                    fontSize: 13,
                    fontWeight: 500,
                    color: '#374151',
                    formatter: function(params) {
                        const percentage = ((params.value / total) * 100).toFixed(1)
                        return `${params.name}\n${percentage}%`
                    }
                },
                emphasis: {
                    label: {
                        show: true,
                        fontSize: 16,
                        fontWeight: 'bold',
                        color: '#1F2937'
                    },
                    itemStyle: {
                        shadowBlur: 10,
                        shadowOffsetX: 0,
                        shadowColor: 'rgba(0, 0, 0, 0.5)'
                    }
                },
                labelLine: {
                    show: true,
                    length: 15,
                    length2: 10,
                    lineStyle: {
                        color: '#D1D5DB',
                        width: 1
                    }
                },
                itemStyle: {
                    borderColor: '#ffffff',
                    borderWidth: 2,
                    shadowColor: 'rgba(0, 0, 0, 0.1)',
                    shadowBlur: 5
                },
                data: data.map(item => ({
                    ...item,
                    itemStyle: {
                        ...item.itemStyle,
                        borderColor: '#ffffff',
                        borderWidth: 2,
                        shadowColor: 'rgba(0, 0, 0, 0.1)',
                        shadowBlur: 5
                    }
                }))
            }]
        }
        
        platformChart.setOption(platformOption)

        // 响应式调整
        window.addEventListener('resize', function() {
            revenueChart.resize()
            platformChart.resize()
        })
    </script>
</body>
</html>