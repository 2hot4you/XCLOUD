# XCloud 多云对账平台

## 项目概述

XCloud是一个专为公有云代理商设计的自动化对账web平台，支持腾讯云、阿里云、华为云、AWS等多个云服务提供商的业务管理和返佣计算。

## 核心功能

### 🏢 客户管理
- 客户信息管理（基本信息、联系方式、业务类型）
- 客户层级管理（一级代理、二级代理等）
- 客户状态跟踪（活跃、暂停、流失）

### 📄 合同管理
- 合同创建、审批、签署流程
- 合同条款管理（价格折扣、返佣比例、结算周期）
- 合同版本控制和到期提醒

### 💼 商务管理
- 价格体系管理（不同云平台的定价策略）
- 折扣政策配置
- 销售机会跟踪

### 💰 实时返佣计算
- 多云平台API集成（腾讯云、阿里云、华为云、AWS等）
- 使用量数据实时同步
- 返佣规则引擎（基于合同条款自动计算）
- 结算周期管理

### 📊 数据统计分析
- 收入统计仪表板
- 客户消费趋势分析
- 云平台使用情况对比
- 返佣发放统计

## 技术架构

### 后端技术栈
- **语言**: Go
- **Web框架**: Gin / Fiber
- **数据库**: PostgreSQL (主库) + Redis (缓存)
- **消息队列**: RabbitMQ / Apache Kafka
- **定时任务**: Cron jobs
- **API文档**: Swagger/OpenAPI

### 前端技术栈 (推荐)
- **框架**: Vue 3 + TypeScript
- **UI组件库**: Ant Design Vue / Element Plus
- **状态管理**: Pinia
- **路由**: Vue Router
- **图表库**: ECharts / Chart.js
- **构建工具**: Vite

### 系统架构
```
┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐
│   前端Web应用    │    │   API网关       │    │   后端服务群    │
│                │    │                │    │                │
│ Vue3 + TS      │◄──►│ Gin/Fiber      │◄──►│ 微服务架构      │
│ Ant Design     │    │ JWT认证        │    │ Go语言         │
└─────────────────┘    └─────────────────┘    └─────────────────┘
                                                      │
                       ┌─────────────────┐            │
                       │   消息队列       │◄───────────┘
                       │ RabbitMQ/Kafka │
                       └─────────────────┘
                                │
        ┌──────────────────────────────────────────────┐
        │                                              │
        ▼                                              ▼
┌─────────────────┐                          ┌─────────────────┐
│   数据库层       │                          │   外部API      │
│                │                          │                │
│ PostgreSQL     │                          │ 腾讯云API      │
│ Redis          │                          │ 阿里云API      │
└─────────────────┘                          │ 华为云API      │
                                            │ AWS API        │
                                            └─────────────────┘
```

## 微服务模块划分

- **用户认证服务**: 用户登录、权限管理
- **客户管理服务**: 客户信息、层级关系管理
- **合同管理服务**: 合同生命周期管理
- **返佣计算服务**: 返佣规则引擎和计算逻辑
- **数据同步服务**: 云平台数据拉取和同步
- **报表统计服务**: 数据分析和报表生成

## 数据库设计

### 核心表结构
- `customers`: 客户信息表
- `contracts`: 合同信息表
- `cloud_providers`: 云服务商配置表
- `billing_data`: 账单数据表（分表存储）
- `commission_rules`: 返佣规则配置表
- `commission_records`: 返佣记录表
- `users`: 用户权限表

### 设计原则
- 使用分表策略处理大量账单数据（按月份分表）
- 建立合理的索引优化查询性能
- 敏感数据加密存储
- 实现软删除机制保证数据完整性

## API集成策略

### 支持的云平台
| 云平台 | API类型 | 数据同步频率 |
|--------|---------|-------------|
| 腾讯云 | 合作伙伴API | 每小时 |
| 阿里云 | 渠道商API | 每小时 |
| 华为云 | 合作伙伴门户API | 每小时 |
| AWS | Partner API | 每小时 |

### 集成特性
- 统一API适配层：标准化不同云平台的数据格式
- 异步数据同步：使用消息队列处理大量数据拉取
- 错误重试机制：确保数据同步的可靠性
- API调用频率控制：避免触发云平台限流

## 开发路线图

### 第一阶段 (MVP) - 2个月
- [ ] 用户认证和权限管理
- [ ] 基础客户管理功能
- [ ] 简单合同管理
- [ ] 基础数据库设计和API框架

### 第二阶段 - 2个月
- [ ] 腾讯云API集成（优先）
- [ ] 基础返佣计算引擎
- [ ] 简单报表和统计
- [ ] 数据同步机制

### 第三阶段 - 2个月
- [ ] 阿里云、华为云API集成
- [ ] 高级返佣规则配置
- [ ] 详细数据分析和可视化
- [ ] 系统性能优化

### 第四阶段 - 2个月
- [ ] AWS API集成
- [ ] 高级报表和BI功能
- [ ] 移动端适配
- [ ] 系统监控和告警

## 安全考虑

- API密钥安全存储（环境变量或密钥管理服务）
- 数据传输加密（HTTPS/TLS）
- 访问日志记录和监控
- 用户权限细粒度控制
- 敏感数据脱敏处理

## 性能优化

- 数据库查询优化和索引设计
- Redis缓存热点数据
- 分表分库策略应对大数据量
- CDN加速静态资源
- API响应时间监控

## 部署架构

### 推荐部署方案
- **容器化**: Docker + Kubernetes
- **负载均衡**: Nginx / ALB
- **数据库**: PostgreSQL主从架构
- **缓存**: Redis集群
- **监控**: Prometheus + Grafana
- **日志**: ELK Stack

## 开发环境搭建

```bash
# 后端环境
go mod init xcloud-backend
go get github.com/gin-gonic/gin
go get gorm.io/gorm

# 前端环境
npm create vue@latest xcloud-frontend
cd xcloud-frontend
npm install ant-design-vue
npm install @types/node
```

## 项目结构

```
XCloud/
├── backend/              # Go后端
│   ├── cmd/             # 应用程序入口
│   ├── internal/        # 内部包
│   ├── pkg/             # 公共包
│   ├── api/             # API定义
│   └── configs/         # 配置文件
├── frontend/            # Vue3前端
│   ├── src/
│   │   ├── components/  # 组件
│   │   ├── views/       # 页面
│   │   ├── store/       # 状态管理
│   │   └── utils/       # 工具函数
│   └── public/          # 静态资源
├── docs/                # 项目文档
├── docker/              # Docker配置
└── scripts/             # 部署脚本
```

## 贡献指南

1. Fork项目
2. 创建特性分支 (`git checkout -b feature/amazing-feature`)
3. 提交更改 (`git commit -m 'Add amazing feature'`)
4. 推送到分支 (`git push origin feature/amazing-feature`)
5. 创建Pull Request

## 许可证

本项目采用 [MIT License](LICENSE)

## 联系方式

- 项目维护者: [Your Name]
- 邮箱: [your.email@example.com]
- 项目地址: [GitHub Repository URL]

---

**注意**: 这是一个企业级项目，涉及财务数据处理，请确保在生产环境中实施充分的安全措施和数据保护机制。